% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scFlow.R
\name{scflow}
\alias{scflow}
\title{Create Flow-like Plots for Gene Expression in Single-Cell/Spatial Data}
\usage{
scflow(
  obj,
  x_gene,
  y_gene,
  ref = NULL,
  group,
  x_cut,
  y_cut,
  assays = "RNA",
  color = c("white", "yellow", "orange", "red"),
  nrow = 2,
  ncol = 3,
  x_label_size = 12,
  y_label_size = 12,
  title_size = 14,
  legend_size = 10,
  axis_text_size = 10,
  common_legend = FALSE,
  cutline_color = "red",
  cutline_size = 0.8,
  point_size = 0.5,
  point_color = "black",
  point_alpha = 0.6,
  theme = "default",
  quad_text_size = 4,
  quad_text_color = "black",
  x_range = NULL,
  y_range = NULL
)
}
\arguments{
\item{obj}{A Seurat object containing gene expression data.}

\item{x_gene}{Character string specifying the gene name for the x-axis.}

\item{y_gene}{Character string specifying the gene name for the y-axis.}

\item{ref}{Optional character string specifying a reference gene. If provided, the function plots
x_gene/ref and y_gene/ref. If NULL, raw expression values are used. Default is NULL.}

\item{group}{Character string specifying which metadata column to use for grouping cells.}

\item{x_cut}{Numeric value for the vertical cutoff line position.}

\item{y_cut}{Numeric value for the horizontal cutoff line position.}

\item{assays}{Character string specifying which assay to use for gene expression data. Default is "RNA".}

\item{color}{Vector of colors defining the density gradient. Default is c("white", "yellow", "orange", "red").}

\item{nrow}{Integer specifying the number of rows in the multi-plot layout. Default is 2.}

\item{ncol}{Integer specifying the number of columns in the multi-plot layout. Default is 3.}

\item{x_label_size}{Numeric value for the size of x-axis label. Default is 12.}

\item{y_label_size}{Numeric value for the size of y-axis label. Default is 12.}

\item{title_size}{Numeric value for the size of plot titles. Default is 14.}

\item{legend_size}{Numeric value for the size of legend text. Default is 10.}

\item{axis_text_size}{Numeric value for the size of axis text. Default is 10.}

\item{common_legend}{Logical indicating whether to use a common legend for all plots. Default is FALSE.}

\item{cutline_color}{Character string specifying the color for cutoff lines. Default is "red".}

\item{cutline_size}{Numeric value for the thickness of cutoff lines. Default is 0.8.}

\item{point_size}{Numeric value for the size of points. Default is 0.5.}

\item{point_color}{Character string specifying the color of points. Default is "black".}

\item{point_alpha}{Numeric value between 0 and 1 for point transparency. Default is 0.6.}

\item{theme}{Character string specifying the theme style ("default" or "dark"). Default is "default".}

\item{quad_text_size}{Numeric value for the size of quadrant percentage text. Default is 4.}

\item{quad_text_color}{Character string specifying the color of quadrant percentage text. Default is "black".}

\item{x_range}{Numeric vector of length 2 specifying the x-axis range. Default is NULL (auto-determined).}

\item{y_range}{Numeric vector of length 2 specifying the y-axis range. Default is NULL (auto-determined).}
}
\value{
A ggpubr arranged plot containing multiple flow plots, one for each cell group.
}
\description{
This function generates a series of flow-like plots to visualize the relationship between two genes
across different cell groups. Each plot shows a 2D density distribution with quadrants defined by
cutoff values, and displays the percentage of cells in each quadrant.
}
\details{
This function creates a series of flow-like plots with:
\enumerate{
\item 2D density visualization of gene expression or gene expression ratios
\item Quadrants defined by user-specified cutoffs
\item Percentage of cells in each quadrant
}

When a reference gene is provided (\code{ref} parameter), the function normalizes expression values
of x_gene and y_gene by dividing by the reference gene expression. This is useful for visualizing
relative expression levels or gene ratios.

The plots are arranged in a grid according to the \code{nrow} and \code{ncol} parameters, with one plot
for each unique value in the specified \code{group} column of the Seurat object's metadata.
}
\examples{
# Load required packages
library(Seurat)
library(dplyr)
library(ggplot2)
library(ggpubr)

# Basic usage - comparing expression of two genes across cell clusters
p1 <- scflow(seurat_obj,
            x_gene = "CD4",
            y_gene = "CD8A",
            group = "seurat_clusters",
            x_cut = 1.0,
            y_cut = 1.0)

# Using a reference gene to normalize expression (gene ratios)
p2 <- scflow(seurat_obj,
            x_gene = "MKI67",
            y_gene = "TOP2A",
            ref = "PCNA",     # Both genes will be normalized by PCNA expression
            group = "celltype",
            x_cut = 0.5,
            y_cut = 0.5)

# Customizing appearance with dark theme and specific axis ranges
p3 <- scflow(seurat_obj,
            x_gene = "IL6",
            y_gene = "TNF",
            group = "treatment",
            x_cut = 1.5,
            y_cut = 1.0,
            theme = "dark",
            color = c("darkblue", "blue", "cyan", "yellow"),
            x_range = c(0, 5),
            y_range = c(0, 4))

# Using a non-standard assay (e.g., for multi-modal data)
p4 <- scflow(seurat_obj,
            x_gene = "CD4",
            y_gene = "CD8A",
            group = "seurat_clusters",
            assays = "ADT",    # Using protein expression data instead of RNA
            x_cut = 2.0,
            y_cut = 2.0)

# Display the plot
print(p1)

# Save the plot with high resolution
ggsave("flow_plot.png", p1, width = 15, height = 10, dpi = 300)

}
