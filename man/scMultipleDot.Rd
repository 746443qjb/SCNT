% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scMultipleDot.R
\name{scMultipleDot}
\alias{scMultipleDot}
\title{Create Multiple Dot Plots for Gene Expression Across Cell Groups and Conditions}
\usage{
scMultipleDot(
  seurat_obj,
  markers,
  group_var = "celltype",
  condition_var = "condition",
  assay_layer = "data",
  color_gradient = c("blue", "yellow"),
  size_range = c(4, 15),
  standardize = TRUE,
  scale_range = c(-2.5, 2.5)
)
}
\arguments{
\item{seurat_obj}{A Seurat object containing gene expression data and metadata.}

\item{markers}{Character vector of gene names to visualize.}

\item{group_var}{Character string specifying which metadata column contains cell group/type
information (e.g., "celltype", "cluster"). Default is "celltype".}

\item{condition_var}{Character string specifying which metadata column contains condition
information (e.g., "treatment", "timepoint"). Default is "condition".}

\item{assay_layer}{Character string specifying which expression data layer to use
("data", "counts", "scale.data"). Default is "data".}

\item{color_gradient}{Vector of colors defining the gradient for expression values.
Default is c("blue", "yellow").}

\item{size_range}{Numeric vector of length 2 specifying the min and max dot sizes.
Default is c(4, 15).}

\item{standardize}{Logical indicating whether to standardize expression values across
groups for each gene. Default is TRUE.}

\item{scale_range}{Numeric vector of length 2 specifying the range to scale standardized
expression values to. Only used when standardize=TRUE. Default is c(-2.5, 2.5).}
}
\value{
A ggplot object representing the faceted dotplot visualization.
}
\description{
This function generates a faceted dotplot visualization showing gene expression patterns
across different cell groups and experimental conditions. Each dot represents a
gene-group-condition combination, where the size indicates the percentage of cells
expressing the gene and the color intensity represents the average expression level.
}
\details{
This function creates a faceted dotplot with:
\enumerate{
\item Genes on the y-axis
\item Conditions on the x-axis
\item Cell groups as facets (columns)
}

For each gene-group-condition combination, the function calculates:
\itemize{
\item Percentage of cells expressing the gene (represented by dot size)
\item Average expression level (represented by dot color)
}

When standardize=TRUE, expression values are log-transformed, standardized across
groups for each gene, and then rescaled to the specified range. When standardize=FALSE,
the raw expression values are used directly.
}
\examples{
# Load required packages
library(Seurat)
library(dplyr)
library(ggplot2)
library(scales)

# Basic usage with default parameters (standardized expression)
genes_of_interest <- c("IL6", "TNF", "IFNG", "IL1B", "IL10")
p1 <- scMultipleDot(seurat_obj,
                   markers = genes_of_interest,
                   group_var = "celltype",
                   condition_var = "treatment")

# Using raw expression values (no standardization)
p2 <- scMultipleDot(seurat_obj,
                   markers = genes_of_interest,
                   group_var = "celltype",
                   condition_var = "treatment",
                   standardize = FALSE)

# Custom color gradient and dot sizes
p3 <- scMultipleDot(seurat_obj,
                   markers = genes_of_interest,
                   color_gradient = c("navy", "white", "firebrick"),
                   size_range = c(2, 12))

# Different grouping variables
p4 <- scMultipleDot(seurat_obj,
                   markers = genes_of_interest,
                   group_var = "seurat_clusters",
                   condition_var = "timepoint")

# Display the plot
print(p1)

# Save the plot with high resolution
ggsave("multiple_dotplot.png", p1, width = 15, height = 8, dpi = 300)

}
